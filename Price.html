<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>📈 أسعار سوق أبوظبي ودبي</title>
  <style>
    body { font-family: Tahoma; background: #eef2f7; padding: 20px; }
    table { width: 100%; border-collapse: collapse; background: white; border: 1px solid #ccc; }
    th, td { padding: 10px; border: 1px solid #ccc; text-align: center; }
    th { background-color: #0a3e7d; color: white; }
    h2 { color: #0a3e7d; margin-bottom: 20px; }
    .error { color: red; }
  </style>
</head>
<body>

<h2>📊 أسعار الأسهم الإماراتية - تحديث مباشر</h2>

<table>
  <thead>
    <tr>
      <th>الرمز</th>
      <th>الاسم</th>
      <th>السعر</th>
      <th>التغير</th>
      <th>النسبة</th>
      <th>السوق</th>
    </tr>
  </thead>
  <tbody id="stock-body">
    <tr><td colspan="6">🔄 جاري تحميل البيانات...</td></tr>
  </tbody>
</table>

<script>
const apiKey = '2d42eaedb65c4d268aa695a0be7ca703'; // 🔑 أدخل مفتاح API من TwelveData

const symbols = [
  'ADAVIATION.AE','ADC.AE','ADCB.AE','ADIB.AE','ADNH.AE','ADNIC.AE','ADNOCDIST.AE','ADNOCDRILL.AE',
  'ADPORTS.AE','ADSB.AE','AGTHIA.AE','AIRARABIA.DU','AJMANBANK.AE','ALAIN.AE','ALDAR.AE','ALFIRDOUS.DU',
  'ALPHADHABI.AE','AMANAT.DU','AMLAK.DU','APEX.AE','ARAM.DU','ARMX.DU','ASCANA.DU','ASM.AE','BBAYANAT.AE',
  'BILDCO.AE','BOROUGE.AE','BOS.DU','BBURJEEL.AE','DANAD.DU','DARTAKAFUL.DU','DEWA.DU','DEYAAR.DU',
  'DFM.DU','DIB.DU','DIC.DU','DRC.DU','DRIVE.AE','DU.DU','EAND.DU','EASYLEASE.AE','EKTTITAB.DU',
  'EMAAR.DU','EMAARDEV.DU','EMIRATESNBD.DU','EMSTEEL.AE','ERC.DU','ESG.AE','ESHRAQ.AE','FAB.AE',
  'FCI.AE','FERTIGLB.AE','GCEM.AE','GHITHA.AE','GULFNAV.DU','HAYAH.AE','IH.AE','IHC.AE','INVICTUS.AE',
  'JULPHAR.AE','MANAZEL.AE','METHAQ.AE','MULTIPLY.AE','NCTH.AE','NIH.AE','NMDC.AE','OEIHC.AE','PALMS.AE',
  'QHOLDING.AE','RAKBANK.AE','RAKCEC.AE','RAKPROP.AE','RAKWCT.AE','RPM.AE','SALAMA.DU','SSALIK.DU',
  'SHUAA.DU','SIB.DU','SUDATEL.DU','TABREED.AE','TAKAFUL_EM.DU','TAQA.AE','TECOM.DU','UNION.AE',
  'UNIONCOOP.DU','UPP.DU','WAHA.AE','YAHSAT.AE','LULU.AE'
];

async function fetchStockData() {
  const tbody = document.getElementById('stock-body');
  tbody.innerHTML = '';

  for (let symbol of symbols) {
    try {
      const response = await fetch(`https://api.twelvedata.com/quote?symbol=${symbol}&apikey=${apiKey}`);
      const data = await response.json();

      const row = document.createElement('tr');

      if (!data.code) {
        row.innerHTML = `
          <td>${data.symbol}</td>
          <td>${data.name || '-'}</td>
          <td>${data.price || '-'}</td>
          <td>${data.change || '-'}</td>
          <td>${data.percent_change ? data.percent_change + '%' : '-'}</td>
          <td>${data.exchange || '-'}</td>
        `;
      } else {
        row.innerHTML = `<td colspan="6" class="error">⚠️ ${symbol}: ${data.message}</td>`;
      }

      tbody.appendChild(row);
    } catch (error) {
      const errorRow = document.createElement('tr');
      errorRow.innerHTML = `<td colspan="6" class="error">❌ فشل تحميل ${symbol}</td>`;
      tbody.appendChild(errorRow);
    }
  }
}

// التحديث كل دقيقة
fetchStockData();
setInterval(fetchStockData, 60000);
</script>

</body>
</html>
