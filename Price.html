<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>📈 أسعار الأسهم المفضلة</title>
  <style>
    body { font-family: Tahoma; background: #eef2f7; padding: 20px; }
    table { width: 100%; border-collapse: collapse; background: white; border: 1px solid #ccc; }
    th, td { padding: 10px; border: 1px solid #ccc; text-align: center; }
    th { background-color: #0a3e7d; color: white; }
    h2 { color: #0a3e7d; margin-bottom: 20px; }
    .error { color: red; }
  </style>
</head>
<body>

<h2>📊 أسعار الأسهم المفضلة (تحديث مباشر)</h2>

<table>
  <thead>
    <tr>
      <th>الرمز</th>
      <th>الاسم</th>
      <th>السعر</th>
      <th>التغير</th>
      <th>النسبة</th>
      <th>السوق</th>
    </tr>
  </thead>
  <tbody id="stock-body">
    <tr><td colspan="6">🔄 جاري تحميل البيانات...</td></tr>
  </tbody>
</table>

<script>
const apiKey = '2d42eaedb65c4d268aa695a0be7ca703'; // 🔑 استبدله بمفتاح TwelveData

const symbols = [
  'ADIB.AE','ADIB.AE','ADIB.AE',
  'DIB.DU','DIB.DU',
  'EMAAR.DU','AIRARABIA.DU',
  'DANA.DU','DANA.DU',
  'ADNOCDIST.AE','ADNOCDIST.AE',
  'EAND.DU','EAND.DU',
  'MULTIPLY.AE','LULU.AE'
];

async function fetchStockData() {
  const tbody = document.getElementById('stock-body');
  tbody.innerHTML = '';

  for (let symbol of symbols) {
    try {
      const response = await fetch(`https://api.twelvedata.com/quote?symbol=${symbol}&apikey=${apiKey}`);
      const data = await response.json();

      const row = document.createElement('tr');

      if (!data.code) {
        row.innerHTML = `
          <td>${data.symbol}</td>
          <td>${data.name || '-'}</td>
          <td>${data.price || '-'}</td>
          <td>${data.change || '-'}</td>
          <td>${data.percent_change ? data.percent_change + '%' : '-'}</td>
          <td>${data.exchange || '-'}</td>
        `;
      } else {
        row.innerHTML = `<td colspan="6" class="error">⚠️ ${symbol}: ${data.message}</td>`;
      }

      tbody.appendChild(row);
    } catch (error) {
      const errorRow = document.createElement('tr');
      errorRow.innerHTML = `<td colspan="6" class="error">❌ فشل تحميل ${symbol}</td>`;
      tbody.appendChild(errorRow);
    }
  }
}

fetchStockData();
setInterval(fetchStockData, 60000); // تحديث كل دقيقة
</script>

</body>
</html>
